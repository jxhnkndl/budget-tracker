(()=>{"use strict";var t,e=indexedDB.open("budget",1);function n(){var e=t.transaction(["pending"],"readwrite").objectStore("pending").getAll();e.onsuccess=function(){e.result.length>0&&fetch("/api/transaction/bulk",{method:"POST",body:JSON.stringify(e.result),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(){t.transaction(["pending"],"readwrite").objectStore("pending").clear()}))}}e.onupgradeneeded=function(t){t.target.result.createObjectStore("pending",{autoIncrement:!0})},e.onsuccess=function(e){t=e.target.result,navigator.onLine&&n()},e.onerror=function(t){console.log("Something went wrong! ".concat(t.target.errorCode))},window.addEventListener("online",n);var o,a=[];function r(){var t=a.reduce((function(t,e){return t+parseInt(e.value)}),0);document.querySelector("#total").textContent=t}function c(){var t=document.querySelector("#tbody");t.innerHTML="",a.forEach((function(e){var n=document.createElement("tr");n.innerHTML="\n      <td>".concat(e.name,"</td>\n      <td>").concat(e.value,"</td>\n    "),t.appendChild(n)}))}function i(){var t=a.slice().reverse(),e=0,n=t.map((function(t){var e=new Date(t.date);return"".concat(e.getMonth()+1,"/").concat(e.getDate(),"/").concat(e.getFullYear())})),r=t.map((function(t){return e+=parseInt(t.value)}));o&&o.destroy();var c=document.getElementById("myChart").getContext("2d");o=new Chart(c,{type:"line",data:{labels:n,datasets:[{label:"Total Over Time",fill:!0,backgroundColor:"#6666ff",data:r}]}})}function u(e){var n=document.querySelector("#t-name"),o=document.querySelector("#t-amount"),u=document.querySelector(".form .error");if(""!==n.value&&""!==o.value){u.textContent="";var l={name:n.value,value:o.value,date:(new Date).toISOString()};e||(l.value*=-1),a.unshift(l),i(),c(),r(),fetch("/api/transaction",{method:"POST",body:JSON.stringify(l),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(t){t.errors?u.textContent="Missing Information":(n.value="",o.value="")})).catch((function(e){var a;a=l,t.transaction(["pending"],"readwrite").objectStore("pending").add(a),n.value="",o.value=""}))}else u.textContent="Missing Information"}fetch("/api/transaction").then((function(t){return t.json()})).then((function(t){a=t,r(),c(),i()})),document.querySelector("#add-btn").onclick=function(){u(!0)},document.querySelector("#sub-btn").onclick=function(){u(!1)}})();